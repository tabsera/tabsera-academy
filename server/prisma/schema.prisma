// Prisma schema for Tabsera Academy

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// User roles enum
enum UserRole {
  STUDENT
  CENTER_ADMIN
  TABSERA_ADMIN
  TUTOR
}

// Tutor application status
enum TutorStatus {
  PENDING
  APPROVED
  REJECTED
  SUSPENDED
}

// Tutoring session status
enum SessionStatus {
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  CANCELLED
  NO_SHOW
}

// Tutor type (fulltime vs freelance)
enum TutorType {
  FULLTIME
  FREELANCE
}

// Recurring session contract status
enum ContractStatus {
  PENDING     // Awaiting tutor response
  ACCEPTED    // Tutor accepted, sessions created
  REJECTED    // Tutor declined
  CANCELLED   // Cancelled by student or tutor
  COMPLETED   // All sessions done
}

// Order status enum
enum OrderStatus {
  PENDING
  PENDING_PAYMENT
  PROCESSING
  COMPLETED
  FAILED
  CANCELLED
  REFUNDED
}

// Payment status enum
enum PaymentStatus {
  PENDING
  APPROVED
  DECLINED
  FAILED
  CANCELLED
  EXPIRED
  TIMEOUT
}

// Payment method enum
enum PaymentMethod {
  MOBILE_MONEY
  CARD
  BANK_TRANSFER
  PAY_AT_CENTER
}

// Country model - for billing/shipping country selection
model Country {
  id              String   @id @default(uuid())
  code            String   @unique // ISO 3166-1 alpha-2 (e.g., "SO", "US")
  name            String   // Full name (e.g., "Somalia")
  dialCode        String?  @map("dial_code") // Phone dial code (e.g., "+252")
  currency        String?  // Currency code (e.g., "USD", "SOS")
  currencySymbol  String?  @map("currency_symbol") // Currency symbol (e.g., "$", "S")
  usdExchangeRate Decimal  @default(1) @map("usd_exchange_rate") @db.Decimal(12, 4) // 1 USD = X local currency
  isActive        Boolean  @default(true) @map("is_active")
  sortOrder       Int      @default(0) @map("sort_order")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  @@map("countries")
}

// Subject model - for categorizing courses
model Subject {
  id          String   @id @default(uuid())
  name        String   @unique // e.g., "Mathematics", "Physics"
  slug        String   @unique // e.g., "mathematics", "physics"
  description String?
  icon        String?  // Icon name or URL
  color       String?  // Hex color for UI display
  sortOrder   Int      @default(0) @map("sort_order")
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  // Relations
  courses     Course[]

  @@map("subjects")
}

// User model
model User {
  id                      String    @id @default(uuid())
  email                   String    @unique
  password                String
  firstName               String    @map("first_name")
  lastName                String    @map("last_name")
  phone                   String?
  country                 String?
  avatar                  String?
  role                    UserRole  @default(STUDENT)
  centerId                String?   @map("center_id")
  isActive                Boolean   @default(true) @map("is_active")
  emailVerified           Boolean   @default(false) @map("email_verified")
  emailVerificationToken  String?   @map("email_verification_token")
  emailVerificationExpires DateTime? @map("email_verification_expires")
  passwordResetToken      String?   @map("password_reset_token")
  passwordResetExpires    DateTime? @map("password_reset_expires")
  // edX integration fields
  edxUsername             String?   @map("edx_username")
  edxPassword             String?   @map("edx_password") // Encrypted edX password for auto-login
  edxRegistered           Boolean   @default(false) @map("edx_registered")
  edxRegisteredAt         DateTime? @map("edx_registered_at")
  // OAuth fields
  googleId                String?   @unique @map("google_id")
  // Admin permissions (JSON) - for TABSERA_ADMIN users
  adminPermissions        Json?     @map("admin_permissions")
  createdAt               DateTime  @default(now()) @map("created_at")
  updatedAt               DateTime  @updatedAt @map("updated_at")

  // Relations
  center            LearningCenter? @relation(fields: [centerId], references: [id])
  orders            Order[]
  enrollments       Enrollment[]
  payments          Payment[]
  certificates      Certificate[]
  tutorProfile      TutorProfile?
  tuitionPurchases  TuitionPackPurchase[]
  studentSessions   TutorSession[]        @relation("StudentSessions")
  studentContracts  RecurringSessionContract[] @relation("StudentContracts")

  @@map("users")
}

// Learning Center model
model LearningCenter {
  id          String   @id @default(uuid())
  name        String
  slug        String   @unique
  description String?
  address     String?
  city        String?
  country     String?
  phone       String?
  email       String?
  logo        String?
  coverImage  String?  @map("cover_image")
  latitude    Float?
  longitude   Float?
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  // Relations
  users       User[]
  orders      Order[]

  @@map("learning_centers")
}

// Learning Pack model - bundles courses and tuition packs (e.g., "IGCSE Complete", "Web Development Pro")
model LearningPack {
  id                 String   @id @default(uuid())
  title              String
  slug               String   @unique
  description        String?  @db.Text
  discountPercentage Decimal  @default(0) @db.Decimal(5, 2) @map("discount_percentage") // Discount % off total price
  duration           String?
  level              String?
  image              String?
  isActive           Boolean  @default(true) @map("is_active")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")

  // Relations - now includes both courses AND tuition packs
  courses      Course[]
  tuitionPacks LearningPackTuitionPack[]
  enrollments  Enrollment[]
  orderItems   OrderItem[]

  @@map("learning_packs")
}

// Junction table for LearningPack <-> TuitionPack many-to-many relationship
model LearningPackTuitionPack {
  id             String       @id @default(uuid())
  learningPackId String       @map("learning_pack_id")
  tuitionPackId  String       @map("tuition_pack_id")
  quantity       Int          @default(1) // How many of this tuition pack included
  createdAt      DateTime     @default(now()) @map("created_at")

  // Relations
  learningPack   LearningPack @relation(fields: [learningPackId], references: [id], onDelete: Cascade)
  tuitionPack    TuitionPack  @relation(fields: [tuitionPackId], references: [id])

  @@unique([learningPackId, tuitionPackId])
  @@map("learning_pack_tuition_packs")
}

// Course model
model Course {
  id              String   @id @default(uuid())
  title           String
  slug            String   @unique
  description     String?
  price           Decimal  @db.Decimal(10, 2)
  creditsFactor   Int      @default(1) @map("credits_factor") // Tuition credit multiplier (1x, 2x, 3x)
  duration        String?
  level           String?
  lessons         Int      @default(0)
  image           String?
  externalUrl     String?  @map("external_url") // EdX or external platform course URL
  edxCourseId     String?  @map("edx_course_id") // Open edX course ID (e.g., "course-v1:TabseraX+CS101+2024")
  learningPackId  String?  @map("learning_pack_id")
  subjectId       String?  @map("subject_id") // Subject category
  isActive        Boolean  @default(true) @map("is_active")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  // Relations
  learningPack  LearningPack?  @relation(fields: [learningPackId], references: [id])
  subject       Subject?       @relation(fields: [subjectId], references: [id])
  enrollments   Enrollment[]
  orderItems    OrderItem[]
  tutorCourses  TutorCourse[]
  tutorSessions TutorSession[]
  contracts     RecurringSessionContract[]

  @@map("courses")
}

// Enrollment model
model Enrollment {
  id              String   @id @default(uuid())
  userId          String   @map("user_id")
  learningPackId  String?  @map("learning_pack_id")
  courseId        String?  @map("course_id")
  progress        Int      @default(0)
  completedLessons Int     @default(0) @map("completed_lessons")
  status          String   @default("active")
  startDate       DateTime @default(now()) @map("start_date")
  completedAt     DateTime? @map("completed_at")
  // edX enrollment tracking
  edxEnrolled     Boolean  @default(false) @map("edx_enrolled")
  edxEnrolledAt   DateTime? @map("edx_enrolled_at")
  edxCourseId     String?  @map("edx_course_id")
  edxEnrollmentMode String? @map("edx_enrollment_mode") @default("honor")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  // Relations
  user         User          @relation(fields: [userId], references: [id])
  learningPack LearningPack? @relation(fields: [learningPackId], references: [id])
  course       Course?       @relation(fields: [courseId], references: [id])

  @@map("enrollments")
}

// Order model
model Order {
  id              String        @id @default(uuid())
  referenceId     String        @unique @map("reference_id")
  userId          String        @map("user_id")
  centerId        String?       @map("center_id")
  status          OrderStatus   @default(PENDING)
  paymentStatus   PaymentStatus @default(PENDING) @map("payment_status")
  paymentMethod   PaymentMethod @map("payment_method")
  subtotal        Decimal       @db.Decimal(10, 2)
  discount        Decimal       @default(0) @db.Decimal(10, 2)
  total           Decimal       @db.Decimal(10, 2)
  currency        String        @default("USD")
  promoCode       String?       @map("promo_code")
  billingFirstName String?      @map("billing_first_name")
  billingLastName  String?      @map("billing_last_name")
  billingEmail    String?       @map("billing_email")
  billingPhone    String?       @map("billing_phone")
  billingCountry  String?       @map("billing_country")
  mobileProvider  String?       @map("mobile_provider")
  createdAt       DateTime      @default(now()) @map("created_at")
  updatedAt       DateTime      @updatedAt @map("updated_at")

  // Relations
  user              User            @relation(fields: [userId], references: [id])
  center            LearningCenter? @relation(fields: [centerId], references: [id])
  items             OrderItem[]
  payments          Payment[]
  tuitionPurchases  TuitionPackPurchase[]

  @@map("orders")
}

// Order Item model
model OrderItem {
  id             String  @id @default(uuid())
  orderId        String  @map("order_id")
  learningPackId String? @map("learning_pack_id")
  courseId       String? @map("course_id")
  tuitionPackId  String? @map("tuition_pack_id")
  name           String
  price          Decimal @db.Decimal(10, 2)
  quantity       Int     @default(1)

  // Relations
  order        Order         @relation(fields: [orderId], references: [id], onDelete: Cascade)
  learningPack LearningPack? @relation(fields: [learningPackId], references: [id])
  course       Course?       @relation(fields: [courseId], references: [id])
  tuitionPack  TuitionPack?  @relation(fields: [tuitionPackId], references: [id])

  @@map("order_items")
}

// Payment model
model Payment {
  id                  String        @id @default(uuid())
  orderId             String        @map("order_id")
  userId              String        @map("user_id")
  transactionId       String?       @unique @map("transaction_id")
  issuerTransactionId String?       @map("issuer_transaction_id")
  waafipayOrderId     String?       @map("waafipay_order_id")
  amount              Decimal       @db.Decimal(10, 2)
  currency            String        @default("USD")
  status              PaymentStatus @default(PENDING)
  paymentMethod       PaymentMethod @map("payment_method")
  payerId             String?       @map("payer_id")
  errorCode           String?       @map("error_code")
  errorMessage        String?       @map("error_message")
  paidAt              DateTime?     @map("paid_at")
  createdAt           DateTime      @default(now()) @map("created_at")
  updatedAt           DateTime      @updatedAt @map("updated_at")

  // Relations
  order Order @relation(fields: [orderId], references: [id])
  user  User  @relation(fields: [userId], references: [id])

  @@map("payments")
}

// Certificate model
model Certificate {
  id             String   @id @default(uuid())
  userId         String   @map("user_id")
  learningPackId String?  @map("learning_pack_id")
  courseId       String?  @map("course_id")
  title          String
  issueDate      DateTime @default(now()) @map("issue_date")
  certificateId  String   @unique @map("certificate_id")
  createdAt      DateTime @default(now()) @map("created_at")

  // Relations
  user User @relation(fields: [userId], references: [id])

  @@map("certificates")
}

// Promo Code model
model PromoCode {
  id            String   @id @default(uuid())
  code          String   @unique
  discountType  String   @map("discount_type") // "percentage" or "fixed"
  discountValue Decimal  @db.Decimal(10, 2) @map("discount_value")
  maxUses       Int?     @map("max_uses")
  usedCount     Int      @default(0) @map("used_count")
  minPurchase   Decimal? @db.Decimal(10, 2) @map("min_purchase")
  expiresAt     DateTime? @map("expires_at")
  isActive      Boolean  @default(true) @map("is_active")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  @@map("promo_codes")
}

// System Settings model - platform-wide configuration
model SystemSettings {
  id          String   @id @default(uuid())
  key         String   @unique  // e.g., "baseCreditPrice", "freelanceCommissionPercent"
  value       String   // JSON or string value
  description String?
  updatedAt   DateTime @updatedAt @map("updated_at")
  updatedBy   String?  @map("updated_by")

  @@map("system_settings")
}

// ============================================
// TUTOR PARTNER SYSTEM MODELS
// ============================================

// Tutor Profile model - extends User with tutor-specific information
model TutorProfile {
  id              String       @id @default(uuid())
  userId          String       @unique @map("user_id")
  bio             String?      @db.Text
  headline        String?      // e.g., "Mathematics Expert | 10+ years experience"
  status          TutorStatus  @default(PENDING)
  tutorType       TutorType    @default(FULLTIME) @map("tutor_type")
  approvedAt      DateTime?    @map("approved_at")
  approvedBy      String?      @map("approved_by")
  rejectionReason String?      @map("rejection_reason") @db.Text
  timezone        String       @default("UTC")
  hourlyRate      Decimal?     @db.Decimal(10, 2) @map("hourly_rate") // Freelance tutor's desired hourly rate
  creditFactor    Int          @default(1) @map("credit_factor")      // Calculated: how many credits per session
  totalSessions   Int          @default(0) @map("total_sessions")
  avgRating       Decimal?     @db.Decimal(3, 2) @map("avg_rating")
  createdAt       DateTime     @default(now()) @map("created_at")
  updatedAt       DateTime     @updatedAt @map("updated_at")

  // Relations
  user            User                  @relation(fields: [userId], references: [id], onDelete: Cascade)
  certifications  TutorCertification[]
  courses         TutorCourse[]
  availability    TutorAvailability[]
  unavailability  TutorUnavailability[]
  sessions        TutorSession[]
  contracts       RecurringSessionContract[]

  @@index([status])
  @@map("tutor_profiles")
}

// Tutor Certification model - uploaded documents proving qualifications
model TutorCertification {
  id              String       @id @default(uuid())
  tutorProfileId  String       @map("tutor_profile_id")
  title           String       // e.g., "Bachelor of Education"
  institution     String       // e.g., "University of Nairobi"
  fileUrl         String       @map("file_url")
  fileName        String       @map("file_name")
  fileSize        Int          @map("file_size") // bytes
  fileType        String       @map("file_type") // mime type
  verified        Boolean      @default(false)
  verifiedAt      DateTime?    @map("verified_at")
  verifiedBy      String?      @map("verified_by")
  createdAt       DateTime     @default(now()) @map("created_at")

  // Relations
  tutorProfile    TutorProfile @relation(fields: [tutorProfileId], references: [id], onDelete: Cascade)

  @@map("tutor_certifications")
}

// Tutor Course model - courses the tutor is proficient in and can teach/grade
model TutorCourse {
  id               String       @id @default(uuid())
  tutorProfileId   String       @map("tutor_profile_id")
  courseId         String       @map("course_id")
  edxStaffEnrolled Boolean      @default(false) @map("edx_staff_enrolled")
  edxEnrolledAt    DateTime?    @map("edx_enrolled_at")
  canGrade         Boolean      @default(false) @map("can_grade")
  createdAt        DateTime     @default(now()) @map("created_at")

  // Relations
  tutorProfile     TutorProfile @relation(fields: [tutorProfileId], references: [id], onDelete: Cascade)
  course           Course       @relation(fields: [courseId], references: [id])

  @@unique([tutorProfileId, courseId])
  @@map("tutor_courses")
}

// Tutor Availability model - weekly recurring availability slots
model TutorAvailability {
  id              String       @id @default(uuid())
  tutorProfileId  String       @map("tutor_profile_id")
  dayOfWeek       Int          @map("day_of_week") // 0=Sunday, 1=Monday, ..., 6=Saturday
  startTime       String       @map("start_time") // "09:00" in tutor's timezone
  endTime         String       @map("end_time")   // "17:00" in tutor's timezone
  isActive        Boolean      @default(true) @map("is_active")
  createdAt       DateTime     @default(now()) @map("created_at")
  updatedAt       DateTime     @updatedAt @map("updated_at")

  // Relations
  tutorProfile    TutorProfile @relation(fields: [tutorProfileId], references: [id], onDelete: Cascade)

  @@unique([tutorProfileId, dayOfWeek, startTime])
  @@map("tutor_availability")
}

// Tutor Unavailability model - date-specific unavailability periods (vacations, sick days, etc.)
model TutorUnavailability {
  id              String       @id @default(uuid())
  tutorProfileId  String       @map("tutor_profile_id")
  startDate       DateTime     @map("start_date")
  endDate         DateTime     @map("end_date")
  reason          String?      // sick, vacation, personal, other
  note            String?      @db.Text
  isActive        Boolean      @default(true) @map("is_active")
  createdAt       DateTime     @default(now()) @map("created_at")
  updatedAt       DateTime     @updatedAt @map("updated_at")

  // Relations
  tutorProfile    TutorProfile @relation(fields: [tutorProfileId], references: [id], onDelete: Cascade)

  @@index([tutorProfileId, startDate, endDate])
  @@map("tutor_unavailability")
}

// Tuition Pack model - purchasable packages of tutoring credits
model TuitionPack {
  id              String   @id @default(uuid())
  name            String   // e.g., "10 Credit Pack"
  description     String?  @db.Text
  creditsIncluded Int      @map("credits_included") // Number of credits (each credit = 10-minute session)
  validityDays    Int      @default(365) @map("validity_days") // Expiry period from purchase date
  price           Decimal  @db.Decimal(10, 2)
  isActive        Boolean  @default(true) @map("is_active")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  // Relations
  purchases       TuitionPackPurchase[]
  orderItems      OrderItem[]
  learningPacks   LearningPackTuitionPack[]

  @@map("tuition_packs")
}

// Tuition Pack Purchase model - student's purchased credit packs
model TuitionPackPurchase {
  id               String      @id @default(uuid())
  userId           String      @map("user_id")
  tuitionPackId    String      @map("tuition_pack_id")
  orderId          String?     @map("order_id")
  creditsTotal     Int         @map("credits_total")
  creditsUsed      Int         @default(0) @map("credits_used")
  creditsRemaining Int         @map("credits_remaining")
  creditsReserved  Int         @default(0) @map("credits_reserved") // Credits reserved for scheduled sessions
  expiresAt        DateTime    @map("expires_at")
  assignedBy       String?     @map("assigned_by") // Admin who manually assigned (null if purchased)
  assignedAt       DateTime?   @map("assigned_at")
  createdAt        DateTime    @default(now()) @map("created_at")
  updatedAt        DateTime    @updatedAt @map("updated_at")

  // Relations
  user              User        @relation(fields: [userId], references: [id])
  tuitionPack       TuitionPack @relation(fields: [tuitionPackId], references: [id])
  order             Order?      @relation(fields: [orderId], references: [id])
  sessions          TutorSession[]

  @@index([userId, creditsRemaining])
  @@map("tuition_pack_purchases")
}

// Tutor Session model - individual tutoring sessions
model TutorSession {
  id                 String        @id @default(uuid())
  tutorProfileId     String        @map("tutor_profile_id")
  studentId          String        @map("student_id")
  purchaseId         String?       @map("purchase_id")
  courseId           String?       @map("course_id")
  contractId         String?       @map("contract_id")  // For recurring sessions
  scheduledAt        DateTime      @map("scheduled_at") // Session start time (UTC)
  duration           Int           @default(20) // minutes (changed from 10 to 20)
  status             SessionStatus @default(SCHEDULED)
  creditsConsumed    Int           @default(1) @map("credits_consumed") // Credits deducted for this session
  creditsRefunded    Boolean       @default(false) @map("credits_refunded") // True if credits were refunded on cancellation
  meetingUrl         String?       @map("meeting_url") // Legacy: Google Meet URL
  meetingId          String?       @map("meeting_id")  // Legacy: Google Meet ID

  // LiveKit video session fields
  livekitRoomName    String?       @map("livekit_room_name")  // Unique room identifier
  livekitRoomSid     String?       @map("livekit_room_sid")   // LiveKit room SID

  // Recording fields
  recordingStatus    String?       @map("recording_status")     // pending, recording, processing, completed, failed
  recordingEgressId  String?       @map("recording_egress_id")  // LiveKit egress ID for recording
  vimeoVideoId       String?       @map("vimeo_video_id")       // Vimeo video ID after upload
  vimeoVideoUrl      String?       @map("vimeo_video_url")      // Vimeo embed/playback URL
  recordingDuration  Int?          @map("recording_duration")   // Recording duration in seconds

  // Whiteboard state for session resumption
  whiteboardSnapshot Json?         @map("whiteboard_snapshot")  // tldraw document state

  topic              String?       // What student wants to discuss
  tutorNotes         String?       @db.Text @map("tutor_notes")
  studentNotes       String?       @db.Text @map("student_notes")
  rating             Int?          // 1-5 rating by student
  feedback           String?       @db.Text
  startedAt          DateTime?     @map("started_at")
  endedAt            DateTime?     @map("ended_at")
  cancelledAt        DateTime?     @map("cancelled_at")
  cancelledBy        String?       @map("cancelled_by") // 'tutor' or 'student'
  cancellationReason String?       @map("cancellation_reason")
  createdAt          DateTime      @default(now()) @map("created_at")
  updatedAt          DateTime      @updatedAt @map("updated_at")

  // Relations
  tutorProfile       TutorProfile           @relation(fields: [tutorProfileId], references: [id])
  student            User                   @relation("StudentSessions", fields: [studentId], references: [id])
  purchase           TuitionPackPurchase?   @relation(fields: [purchaseId], references: [id])
  course             Course?                @relation(fields: [courseId], references: [id])
  contract           RecurringSessionContract? @relation("ContractSessions", fields: [contractId], references: [id])

  @@index([tutorProfileId, status])
  @@index([studentId, status])
  @@index([scheduledAt])
  @@index([contractId])
  @@map("tutor_sessions")
}

// Recurring Session Contract model - for weekly recurring sessions
model RecurringSessionContract {
  id              String         @id @default(uuid())
  studentId       String         @map("student_id")
  tutorProfileId  String         @map("tutor_profile_id")
  courseId        String?        @map("course_id")

  // Schedule
  startDate       DateTime       @map("start_date")
  endDate         DateTime       @map("end_date")
  daysOfWeek      Int[]          @map("days_of_week")  // [1,3,5] = Mon,Wed,Fri
  timeSlot        String         @map("time_slot")      // "14:00" or "14:30"
  slotCount       Int            @default(1) @map("slot_count") // 1-4 slots per session
  topic           String?

  // Status
  status          ContractStatus @default(PENDING)

  // Credits
  totalCredits    Int            @map("total_credits")
  reservedCredits Int            @default(0) @map("reserved_credits")
  usedCredits     Int            @default(0) @map("used_credits")
  refundedCredits Int            @default(0) @map("refunded_credits")

  // Tutor response
  respondedAt     DateTime?      @map("responded_at")
  rejectionReason String?        @map("rejection_reason")

  // Cancellation
  cancelledAt     DateTime?      @map("cancelled_at")
  cancelledBy     String?        @map("cancelled_by")  // 'student' or 'tutor'
  cancellationReason String?     @map("cancellation_reason")

  createdAt       DateTime       @default(now()) @map("created_at")
  updatedAt       DateTime       @updatedAt @map("updated_at")

  // Relations
  student         User           @relation("StudentContracts", fields: [studentId], references: [id])
  tutorProfile    TutorProfile   @relation(fields: [tutorProfileId], references: [id])
  course          Course?        @relation(fields: [courseId], references: [id])
  sessions        TutorSession[] @relation("ContractSessions")

  @@index([studentId, status])
  @@index([tutorProfileId, status])
  @@map("recurring_session_contracts")
}
